{# Custom h-card template that includes hidden photo for webmention parsers #}
<!-- CUSTOM H-CARD TEMPLATE -->
<div class="h-card">
  {# For posts, we need to manually add the photo and URL since profile lookup might fail #}
  {% if user and user.username == "jochen" %}
    <img class="u-photo" src="https://wersdoerfer.de/media/images/jochen.jpg" alt="Jochen WersdÃ¶rfer" style="display: none;">
    <a class="u-url" href="https://wersdoerfer.de/jochen/" rel="me" style="display: none;">Profile</a>
  {% endif %}

  {# Original photo logic as backup #}
  {% if h_card.photo %}
    {% for photo in h_card.photo %}
      {% if photo.value %}
        <img class="u-photo" src="{{ photo.value }}" alt="{{ photo.alt|default:profile.name|default:user.username }}" style="display: none;">
      {% else %}
        <img class="u-photo" src="{{ photo }}" alt="{{ profile.name|default:user.username }}" style="display: none;">
      {% endif %}
    {% endfor %}
  {% elif profile and profile.photo_url %}
    <img class="u-photo" src="{{ profile.photo_url }}" alt="{{ profile.name|default:user.username }}" style="display: none;">
  {% endif %}

  <div class="p-name">
    {{ profile.name|default:user.username }}
  </div>

  {% if h_card.url %}
    {% for url in h_card.url %}
      <a class="u-url" href="{{ url }}" {% if forloop.first %}rel="me"{% endif %} style="display: none;">
        {% if forloop.first %}
          Profile
        {% else %}
          {{ url }}
        {% endif %}
      </a>
    {% endfor %}
  {% elif profile and profile.url %}
    <a class="u-url" href="{{ profile.url }}" rel="me" style="display: none;">Profile</a>
  {% endif %}

  {% if h_card.email %}
    {% for email in h_card.email %}
      <a class="u-email" href="mailto:{{ email }}" style="display: none;">{{ email }}</a>
    {% endfor %}
  {% endif %}

  {% if h_card.tel %}
    {% for tel in h_card.tel %}
      <span class="p-tel" style="display: none;">{{ tel }}</span>
    {% endfor %}
  {% endif %}

  {% if h_card.note %}
    {% for note in h_card.note %}
      <p class="p-note" style="display: none;">{{ note }}</p>
    {% endfor %}
  {% endif %}

  {% if h_card.adr %}
    {% for adr in h_card.adr %}
      <div class="p-adr h-adr" style="display: none;">
        {% if adr.locality %}<span class="p-locality">{{ adr.locality }}</span>{% endif %}
        {% if adr.region %}<span class="p-region">{{ adr.region }}</span>{% endif %}
        {% if adr.country_name %}<span class="p-country-name">{{ adr.country_name }}</span>{% endif %}
      </div>
    {% endfor %}
  {% endif %}

  {% if h_card.org %}
    {% for org in h_card.org %}
      <div class="p-org h-card" style="display: none;">
        {% if org.name %}<span class="p-name">{{ org.name }}</span>{% endif %}
        {% if org.url %}<a class="u-url" href="{{ org.url }}">{{ org.url }}</a>{% endif %}
      </div>
    {% endfor %}
  {% endif %}
</div>
